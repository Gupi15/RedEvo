/* ==========================================================
   JUEGO.CSS — TODO LO VISUAL DEL JUEGO (AUTOSUFICIENTE)
   - Incluye: variables, reset, utilidades, botones,
     panel de autenticación, layout del juego, HUD, tablero,
     jugador, objetos, overlays y responsive.
   - 100% en medidas relativas (% / vh / em). Sin px.
   ========================================================== */


/* ==========================================================
   1) VARIABLES DE TEMA Y JUEGO
   ========================================================== */
:root{
  /* Colores base del tema */
  --fondo: #0f172a;
  --panel: #111827cc;
  --texto: #e5e7eb;
  --verde: #22c55e;
  --rojo: #ef4444;
  --amarillo: #f59e0b;

  /* Tipografía relativa */
  --fs-100: 100%;
  --fs-120: 120%;
  --fs-140: 140%;
  --fs-180: 180%;
  --fs-220: 220%;
  --fs-300: 300%;

  /* Radios y espacios */
  --radio-sm: 3%;
  --radio-md: 6%;
  --radio-lg: 12%;
  --gap-1: 2%;
  --gap-2: 3%;
  --gap-3: 4%;

  /* Medidas del jugador y objetos (gameplay) */
  --rata-ancho: 10%;
  --rata-alto: 10%;
  --obj-ancho: 6%;
  --obj-alto: 8%;

  /* Velocidades informativas en %/s */
  --vel-min: 18%;
  --vel-max: 35%;

  /* Tamaños de HUD y textos in‑game */
  --fs-hud: 220%;
  --fs-stats: 140%;
  --fs-best: 120%;
  --fs-msg-h2: 240%;
  --fs-msg-p: 140%;
  --fs-ayuda: 120%;
}


/* ==========================================================
   2) RESETEO BÁSICO + BODY
   ========================================================== */
*{ box-sizing: border-box; }
html, body{ height:100%; margin:0; }
body{
  background: radial-gradient(60% 60% at 50% 40%, #1f2937 0%, var(--fondo) 70%);
  color: var(--texto);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: var(--fs-100);
  line-height: 140%;
}


/* ==========================================================
   3) UTILIDADES GENERALES
   ========================================================== */
.oculto{ display:none !important; }


/* ==========================================================
   4) BOTONES GENERALES
   ========================================================== */
.btn{
  border:none;
  background:#334155;
  color:var(--texto);
  padding:1.2% 2.4%;
  border-radius: var(--radio-lg);
  cursor:pointer;
  display:inline-grid; place-items:center;
  text-decoration:none;
  font-size: var(--fs-120);
}
.btn:hover{ filter:brightness(1.1); }
.btn.grande{ padding:2.4% 4.8%; font-size: var(--fs-140); }
.btn.active{ outline:.3% solid #64748b; }
.btn.ghost{
  background: #0b1320aa;
  outline: .2% solid #253047;
}


/* ==========================================================
   5) PANEL DE AUTENTICACIÓN (si el login vive en juego.html)
   ========================================================== */
.panel.auth{
  display:grid; place-items:center;
  background: linear-gradient(180deg, #0b1020aa, #0b1020aa);
  border-radius: var(--radio-md);
  outline:.3% solid #1f2937;
  padding: var(--gap-2);
}
.panel.auth .tabs{ display:flex; gap:var(--gap-1); margin-bottom:var(--gap-1); }

.form{
  width:60%;
  display:grid; gap:var(--gap-2);
  background:#0b1320aa; padding:3.2%;
  border-radius: var(--radio-sm);
}
.form label{ display:grid; gap:1%; font-size: var(--fs-120); }
.form input{
  width:100%; padding:2%;
  border-radius: 8%;
  border:none; outline:.2% solid #334155;
  background:#0b1220; color:var(--texto);
  font-size: var(--fs-120);
}
.msg{ margin-top:2%; font-size: var(--fs-120); opacity:.85; }


/* ==========================================================
   6) LAYOUT PRINCIPAL DEL JUEGO
   - Grid de 3 filas: HUD / Tablero / Ayuda
   ========================================================== */
.app{
  width:100%;
  height:100%;
  display:grid;
  grid-template-rows: 10% 1fr 10%;
  gap:2%;
  padding:2%;
}


/* ==========================================================
   7) HUD / ENCABEZADO SUPERIOR
   ========================================================== */
.hud{
  display:grid;
  grid-template-columns: 1fr auto auto; /* título | stats | logout */
  align-items:center;
  gap:2%;
  background: var(--panel);
  border-radius: 2%;
  padding: 1.5% 2%;
}
.titulo{
  font-weight:700;
  letter-spacing:.05em;
  font-size: var(--fs-hud);
}
.stats{ display:flex; gap:12%; font-size: var(--fs-stats); }
.user-tag{ opacity:.8; }


/* ==========================================================
   8) TABLERO DE JUEGO
   ========================================================== */
.tablero{
  position:relative;
  width:100%; height:100%;
  background: repeating-linear-gradient(
    to bottom, #0b1020 0%, #0b1020 2%, #0c1326 2%, #0c1326 4%
  );
  border-radius:2%;
  overflow:hidden;                 /* oculta objetos que salen */
  outline:.3% solid #1f2937;       /* borde sutil */
}


/* ==========================================================
   9) SIDEBAR FLOTANTE EN EL TABLERO
   ========================================================== */
.sidebar{
  position:absolute; left:1%; top:2%;
  display:grid; gap:8%;
  background:#0b1320aa; padding:2%; border-radius:4%;
}
.best{ font-size: var(--fs-best); }


/* ==========================================================
   10) JUGADOR: LA RATA
   ========================================================== */
.rata{
  position:absolute; left:45%; bottom:2%;
  width:var(--rata-ancho); height:var(--rata-alto);
  transform:translateX(-50%);
  background:none;
  box-shadow: 0 2% 6% #00000055;
  will-change: transform;
}
/* Imagen dentro de la rata */
.rata img{
  width:100%; height:100%;
  object-fit: contain;
  display:block;
  user-select: none;
  pointer-events: none;
  image-rendering: auto; /* para pixel-art cambiar a crisp-edges */
}


/* ==========================================================
   11) OBJETOS QUE CAEN (buenos/malos)
   ========================================================== */
.obj{
  position:absolute;
  width:var(--obj-ancho); height:var(--obj-alto);
  display:grid; place-items:center;
  font-size: 150%;
  user-select:none; pointer-events:none;
}
.obj.bueno{ filter: drop-shadow(0 2% 6% #00000066); }
.obj.malo{ filter: drop-shadow(0 2% 6% #00000066) hue-rotate(30deg); }


/* ==========================================================
   12) OVERLAY / MENSAJES CENTRADOS
   ========================================================== */
.mensaje{
  position:absolute; inset:0;
  display:grid; place-items:center;
  background:#00000055; text-align:center;
}
.mensaje.oculto{ display:none; }
.mensaje h2{ margin:0 0 1%; font-size: var(--fs-msg-h2); }
.mensaje p{ margin:0 0 2%; font-size: var(--fs-msg-p); }


/* ==========================================================
   13) PIE DE AYUDA
   ========================================================== */
.ayuda{ display:grid; place-items:center; font-size: var(--fs-ayuda); opacity:.85; }


/* ==========================================================
   14) RESPONSIVE DEL JUEGO
   - Breakpoints relativos con em. Sin px.
   ========================================================== */
@media (max-width: 60em){
  .stats{ gap:6%; }
  .form{ width:80%; } /* si el login convive en esta vista */
}
@media (max-width: 40em){
  .hud{ grid-template-columns: 1fr auto; gap:4%; }
  .titulo{ font-size: 180%; }
  .stats{ font-size: 120%; }
  .sidebar{ gap:6%; padding:3%; }
  .rata{ width:12%; height:12%; }
  .obj{ width:7%; height:9%; }
}

/* ==========================================================
   RESPONSIVE MÓVIL — Overrides y mejoras de usabilidad
   - Objetivo: pantallas < 480–600px de ancho
   - Solo añadimos reglas; no eliminamos desktop
   ========================================================== */

/* ---------- 1) Ajustes generales y “notch” ---------- */
@media (max-width: 40em){ /* ~640px */
  /* padding que respeta notch/barras */
  .app{
    padding: calc(2% + env(safe-area-inset-top))
             calc(2% + env(safe-area-inset-right))
             calc(2% + env(safe-area-inset-bottom))
             calc(2% + env(safe-area-inset-left));
    gap: 3%;
    grid-template-rows: auto 1fr auto; /* HUD auto-alto */
  }

  /* tipografías más legibles en móvil */
  :root{
    --fs-hud: 180%;
    --fs-stats: 130%;
    --fs-best: 120%;
    --fs-msg-h2: 220%;
    --fs-msg-p: 130%;
    --fs-ayuda: 120%;

    /* jugador y objetos ligeramente más grandes */
    --rata-ancho: 12%;
    --rata-alto: 12%;
    --obj-ancho: 7%;
    --obj-alto: 9%;
  }

  /* ---------- 2) HUD compacto en una columna ---------- */
  .hud{
    grid-template-columns: 1fr;   /* título arriba */
    row-gap: 2%;
    padding: 3% 3%;
  }
  .titulo{ text-align:center; }
  .stats{
    justify-content: center;
    gap: 8%;
    font-size: var(--fs-stats);
  }
  .hud .btn{ justify-self: center; padding: 3% 6%; } /* touch target */

  /* ---------- 3) Tablero: relación vertical y scroll cero ---------- */
  .tablero{
    /* alto siempre visible sin “saltar” por barras del sistema */
    min-height: 70vh;          /* suficiente área jugable */
    aspect-ratio: 9 / 16;      /* vertical-friendly */
  }

  /* ---------- 4) Sidebar: convertir en barra inferior ---------- */
  .sidebar{
    left: 50%; bottom: 3%; top: auto;
    transform: translateX(-50%);
    display: grid; grid-auto-flow: column;
    gap: 4%;
    padding: 3% 4%;
    border-radius: 8%;
  }

  /* ---------- 5) Overlay: botones y textos más grandes ---------- */
  .mensaje h2{ font-size: var(--fs-msg-h2); }
  .mensaje p{  font-size: var(--fs-msg-p); }
  .btn.grande{ padding: 3.5% 7%; font-size: 150%; }
}

/* ---------- 6) Ultra-compacto (<360–400px de ancho) ---------- */
@media (max-width: 25em){ /* ~400px */
  :root{
    --rata-ancho: 14%;
    --rata-alto: 14%;
    --obj-ancho: 8%;
    --obj-alto: 10%;
  }
  .stats{ gap: 5%; }
  .sidebar{ gap: 3%; padding: 4% 5%; }
}

/* ---------- 7) Evitar desplazamientos horizontales ---------- */
@media (max-width: 60em){
  html, body{ overflow-x: hidden; }
  .mensaje{ padding: 4%; }
}

/* ---------- 8) Preferencias del usuario (reduce motion) ---------- */
@media (prefers-reduced-motion: reduce){
  .rata, .obj{ transition: none !important; animation: none !important; }
}
